

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Introduction to Foolscap &mdash; Foolscap v0.6.1 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.6.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Foolscap v0.6.1 documentation" href="index.html" />
    <link rel="next" title="Using Pass-By-Copy in Foolscap" href="copyable.html" />
    <link rel="prev" title="Welcome to Foolscap’s documentation!" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="copyable.html" title="Using Pass-By-Copy in Foolscap"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to Foolscap’s documentation!"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Foolscap v0.6.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="introduction-to-foolscap">
<h1>Introduction to Foolscap<a class="headerlink" href="#introduction-to-foolscap" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Suppose you find yourself in control of both ends of the wire: you have
two programs that need to talk to each other, and you get to use any protocol
you want. If you can think of your problem in terms of objects that need to
make method calls on each other, then chances are good that you can use the
Foolscap protocol rather than trying to shoehorn your needs into something
like HTTP, or implementing yet another RPC mechanism.</p>
<p>Foolscap is based upon a few central concepts:</p>
<ul class="simple">
<li><em>serialization</em> : taking fairly arbitrary objects and types,
turning them into a chunk of bytes, sending them over a wire, then
reconstituting them on the other end. By keeping careful track of object
ids, the serialized objects can contain references to other objects and the
remote copy will still be useful.</li>
<li><em>remote method calls</em> : doing something to a local proxy and
causing a method to get run on a distant object. The local proxy is called
a <a class="reference external" href="http://foolscap.lothar.com/docs/api/foolscap.referenceable.RemoteReference-class.html">RemoteReference</a> ,
and you &#8220;do something&#8221; by running its <tt class="docutils literal"><span class="pre">.callRemote</span></tt> method.
The distant object is called a <a class="reference external" href="http://foolscap.lothar.com/docs/api/foolscap.referenceable.Referenceable-class.html">Referenceable</a> , and it has methods like
<tt class="docutils literal"><span class="pre">remote_foo</span></tt> that will be invoked.</li>
</ul>
<p>Foolscap is the descendant of Perspective Broker (which lived in the
twisted.spread package). For many years it was known as &#8220;newpb&#8221;. A lot of the
API still has the name &#8220;PB&#8221; in it somewhere. These will probably go away
sooner or later.</p>
<p>A &#8220;foolscap&#8221; is a size of paper, probably measuring 17 by 13.5 inches. A
twisted foolscap of paper makes a good fool&#8217;s cap. Also, &#8220;cap&#8221; makes me think
of capabilities, and Foolscap is a protocol to implement a distributed
object-capabilities model in python.</p>
</div>
<div class="section" id="getting-started">
<h2>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>Any Foolscap application has at least two sides: one which hosts a
remotely-callable object, and another which calls (remotely) the methods of
that object. We&#8217;ll start with a simple example that demonstrates both ends.
Later, we&#8217;ll add more features like RemoteInterface declarations, and
transferring object references.</p>
<p>The most common way to make an object with remotely-callable methods is to
subclass <a class="reference external" href="http://foolscap.lothar.com/docs/api/foolscap.referenceable.Referenceable-class.html">Referenceable</a> . Let&#8217;s create a simple
server which does basic arithmetic. You might use such a service to perform
difficult mathematical operations, like addition, on a remote machine which
is faster and more capable than your own <a class="footnote-reference" href="#id12" id="id1">[1]</a> .</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">foolscap.api</span> <span class="kn">import</span> <span class="n">Referenceable</span>

<span class="k">class</span> <span class="nc">MathServer</span><span class="p">(</span><span class="n">Referenceable</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">remote_add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span>
    <span class="k">def</span> <span class="nf">remote_subtract</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">-</span><span class="n">b</span>
    <span class="k">def</span> <span class="nf">remote_sum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span> <span class="n">total</span> <span class="o">+=</span> <span class="n">a</span>
        <span class="k">return</span> <span class="n">total</span>

<span class="n">myserver</span> <span class="o">=</span> <span class="n">MathServer</span><span class="p">()</span>
</pre></div>
</div>
<p>On the other end of the wire (which you might call the &#8220;client&#8221;
side), the code will have a <a class="reference external" href="http://foolscap.lothar.com/docs/api/foolscap.referenceable.RemoteReference-class.html">RemoteReference</a> to this object. The``RemoteReference`` has a method named <a class="reference external" href="http://foolscap.lothar.com/docs/api/foolscap.referenceable.RemoteReference-class.html#callRemote">callRemote</a> which you
will use to invoke the method. It always returns a Deferred, which will fire
with the result of the method. Assuming you&#8217;ve already acquired the``RemoteReference`` , you would invoke the method like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">gotAnswer</span><span class="p">(</span><span class="n">result</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&quot;result is&quot;</span><span class="p">,</span> <span class="n">result</span>
<span class="k">def</span> <span class="nf">gotError</span><span class="p">(</span><span class="n">err</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&quot;error:&quot;</span><span class="p">,</span> <span class="n">err</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">remote</span><span class="o">.</span><span class="n">callRemote</span><span class="p">(</span><span class="s">&quot;add&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">addCallbacks</span><span class="p">(</span><span class="n">gotAnswer</span><span class="p">,</span> <span class="n">gotError</span><span class="p">)</span>
</pre></div>
</div>
<p>Ok, now how do you acquire that <tt class="docutils literal"><span class="pre">RemoteReference</span></tt> ? How do you
make the <tt class="docutils literal"><span class="pre">Referenceable</span></tt> available to the outside world? For this,
we&#8217;ll need to discuss the &#8220;Tub&#8221; , and the concept of a &#8220;FURL&#8221; .</p>
</div>
<div class="section" id="tubs-the-foolscap-service">
<h2>Tubs: The Foolscap Service<a class="headerlink" href="#tubs-the-foolscap-service" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="http://foolscap.lothar.com/docs/api/foolscap.pb.Tub-class.html">Tub</a> is the container that
you use to publish <tt class="docutils literal"><span class="pre">Referenceable</span></tt> s, and is the middle-man you use
to access <tt class="docutils literal"><span class="pre">Referenceable</span></tt> s on other systems. It is known as the&#8221;Tub&#8221; , since it provides similar naming and identification properties as
the <a class="reference external" href="http://www.erights.org/">E language</a> &#8216;s &#8220;Vat&#8221;  <a class="footnote-reference" href="#id13" id="id2">[2]</a> . If
you want to make a <tt class="docutils literal"><span class="pre">Referenceable</span></tt> available to the world, you
create a Tub, tell it to listen on a TCP port, and then register the``Referenceable`` with it under a name of your choosing. If you want
to access a remote <tt class="docutils literal"><span class="pre">Referenceable</span></tt> , you create a Tub and ask it to
acquire a <tt class="docutils literal"><span class="pre">RemoteReference</span></tt> using that same name.</p>
<p>The <tt class="docutils literal"><span class="pre">Tub</span></tt> is a Twisted <a class="reference external" href="http://foolscap.lothar.com/docs/api/twisted.application.service.Service-class.html">Service</a> subclass, so you use it in
the same way: once you&#8217;ve created one, you attach it to a parent Service or
Application object. Once the top-level Application object has been started,
the Tub will start listening on any network ports you&#8217;ve requested. When the
Tub is shut down, it will stop listening and drop any connections it had
established since last startup. If you have no parent to attach it to, you
can use <tt class="docutils literal"><span class="pre">startService</span></tt> and <tt class="docutils literal"><span class="pre">stopService</span></tt> on the Tub
directly.</p>
<p>Note that no network activity will occur until the Tub&#8217;s``startService`` method has been called. This means that any``getReference`` or <tt class="docutils literal"><span class="pre">connectTo</span></tt> requests that occur
before the Tub is started will be deferred until startup. If the program
forgets to start the Tub, these requests will never be serviced. A message to
this effect is added to the twistd.log file to help developers discover this
kind of problem.</p>
<div class="section" id="making-your-tub-remotely-accessible">
<h3>Making your Tub remotely accessible<a class="headerlink" href="#making-your-tub-remotely-accessible" title="Permalink to this headline">¶</a></h3>
<p>To make any of your <tt class="docutils literal"><span class="pre">Referenceable</span></tt> s available, you must make
your Tub available. There are three parts: give it an identity, have it
listen on a port, and tell it the protocol/hostname/portnumber at which that
port is accessibly to the outside world.</p>
<p>In general, the Tub will generate its own identity, the <em>TubID</em> , by
creating an SSL public key certificate and hashing it into a suitably-long
random-looking string. This is the primary identifier of the Tub: everything
else is just a <em>location hint</em> that suggests how the Tub might be
reached. The fact that the TubID is tied to the public key allows FURLs to
be &#8220;secure&#8221; references (meaning that no third party can cause you to
connect to the wrong reference). You can also create a Tub with a
pre-existing certificate, which is how Tubs can retain a persistent identity
over multiple executions.</p>
<p>You can also create an <tt class="docutils literal"><span class="pre">UnauthenticatedTub</span></tt> , which has an empty
TubID. Hosting and connecting to unauthenticated Tubs do not require the
pyOpenSSL library, but do not provide privacy, authentication, connection
redirection, or shared listening ports. The FURLs that point to
unauthenticated Tubs have a distinct form (starting with <tt class="docutils literal"><span class="pre">pbu:</span></tt>
instead of <tt class="docutils literal"><span class="pre">pb:</span></tt> ) to make sure they are not mistaken for
authenticated Tubs. Foolscap uses authenticated Tubs by default.</p>
<p>Having the Tub listen on a TCP port is as simple as calling <a class="reference external" href="http://foolscap.lothar.com/docs/api/foolscap.pb.Tub-class.html#listenOn">listenOn</a> with a <a class="reference external" href="http://foolscap.lothar.com/docs/api/twisted.application-class.html#strports">strports</a> -formatted port specification
string. The simplest such string would be &#8220;<a class="reference external" href="tcp:12345">tcp:12345</a>&#8221; , to listen on port
12345 on all interfaces. Using &#8220;<a class="reference external" href="tcp:12345:interface=127.0.0.1">tcp:12345:interface=127.0.0.1</a>&#8221; would
cause it to only listen on the localhost interface, making it available only
to other processes on the same host. The <tt class="docutils literal"><span class="pre">strports</span></tt> module
provides many other possibilities.</p>
<p>The Tub needs to be told how it can be reached, so it knows what host and
port to put into the FURLs it creates. This location is simply a string in
the format &#8220;host:port&#8221; , using the host name by which that TCP port
you&#8217;ve just opened can be reached. Foolscap cannot, in general, guess what
this name is, especially if there are NAT boxes or port-forwarding devices in
the way. If your machine is reachable directly over the internet as&#8221;myhost.example.com&#8221; , then you could use something like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">foolscap.api</span> <span class="kn">import</span> <span class="n">Tub</span>

<span class="n">tub</span> <span class="o">=</span> <span class="n">Tub</span><span class="p">()</span>
<span class="n">tub</span><span class="o">.</span><span class="n">listenOn</span><span class="p">(</span><span class="s">&quot;tcp:12345&quot;</span><span class="p">)</span>  <span class="c"># start listening on TCP port 12345</span>
<span class="n">tub</span><span class="o">.</span><span class="n">setLocation</span><span class="p">(</span><span class="s">&quot;myhost.example.com:12345&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="registering-the-referenceable">
<h3>Registering the Referenceable<a class="headerlink" href="#registering-the-referenceable" title="Permalink to this headline">¶</a></h3>
<p>Once the Tub has a Listener and a location, you can publish your``Referenceable`` to the entire world by picking a name and
registering it:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">furl</span> <span class="o">=</span> <span class="n">tub</span><span class="o">.</span><span class="n">registerReference</span><span class="p">(</span><span class="n">myserver</span><span class="p">,</span> <span class="s">&quot;math-service&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This returns the &#8220;FURL&#8221; for your <tt class="docutils literal"><span class="pre">Referenceable</span></tt> . Remote
systems will use this FURL to access your newly-published object. The
registration just maps a per-Tub name to the <tt class="docutils literal"><span class="pre">Referenceable</span></tt> :
technically the same <tt class="docutils literal"><span class="pre">Referenceable</span></tt> could be published multiple
times, under different names, or even be published by multiple Tubs in the
same application. But in general, each program will have exactly one Tub, and
each object will be registered under only one name.</p>
<p>In this example (if we pretend the generated TubID was &#8220;ABCD&#8221; ), the
FURL returned by <tt class="docutils literal"><span class="pre">registerReference</span></tt> would be``&#8221;pb://ABCD&#64;myhost.example.com:12345/math-service&#8221;`` .</p>
<p>If you do not provide a name, a random (and unguessable) name will be
generated for you. This is useful when you want to give access to your``Referenceable`` to someone specific, but do not want to make it
possible for someone else to acquire it by guessing the name.</p>
<p>To use an unauthenticated Tub instead, you would do the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">foolscap.api</span> <span class="kn">import</span> <span class="n">UnauthenticatedTub</span>

<span class="n">tub</span> <span class="o">=</span> <span class="n">UnauthenticatedTub</span><span class="p">()</span>
<span class="n">tub</span><span class="o">.</span><span class="n">listenOn</span><span class="p">(</span><span class="s">&quot;tcp:12345&quot;</span><span class="p">)</span>  <span class="c"># start listening on TCP port 12345</span>
<span class="n">tub</span><span class="o">.</span><span class="n">setLocation</span><span class="p">(</span><span class="s">&quot;myhost.example.com:12345&quot;</span><span class="p">)</span>
<span class="n">furl</span> <span class="o">=</span> <span class="n">tub</span><span class="o">.</span><span class="n">registerReference</span><span class="p">(</span><span class="n">myserver</span><span class="p">,</span> <span class="s">&quot;math-service&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>In this case, the FURL would be``&#8221;pbu://myhost.example.com:12345/math-service&#8221;`` . The deterministic
nature of this form makes it slightly easier to throw together
quick-and-dirty Foolscap applications, since you only need to hard-code the
target host and port into the client side program. However any serious
application should just used the default authenticated form and use a full
FURL as their starting point. Note that the FURL can come from anywhere:
typed in by the user, retrieved from a web page, or hardcoded into the
application.</p>
<div class="section" id="using-a-persistent-certificate">
<h4>Using a persistent certificate<a class="headerlink" href="#using-a-persistent-certificate" title="Permalink to this headline">¶</a></h4>
<p>The Tub uses a TLS public-key certificate as the base of all its
cryptographic operations. If you don&#8217;t give it one when you create the Tub,
it will generate a brand-new one.</p>
<p>The TubID is simply the hash of this certificate, so if you are writing an
application that should have a stable long-term identity, you will need to
insure that the Tub uses the same certificate every time your app starts. The
easiest way to do this is to pass the <tt class="docutils literal"><span class="pre">certFile=</span></tt> argument into
your <tt class="docutils literal"><span class="pre">Tub()</span></tt> constructor call. This argument provides a filename
where you want the Tub to store its certificate. The first time the Tub is
started (when this file does not exist), the Tub will generate a new
certificate and store it here. On subsequent invocations, the Tub will read
the earlier certificate from this location. Make sure this filename points to
a writable location, and that you pass the same filename to``Tub()`` each time.</p>
</div>
<div class="section" id="using-a-persistent-furl">
<h4>Using a Persistent FURL<a class="headerlink" href="#using-a-persistent-furl" title="Permalink to this headline">¶</a></h4>
<p>It is often useful to insure that a given Referenceable&#8217;s FURL is both
unguessable and stable, remaining the same from one invocation of the program
that hosts it to the next. One (bad) way to do this is to have the programmer
choose an unguessable name, embed it in the program, and pass it into``registerReference`` each time the program runs, but of course this
means that the name will be visible to anyone who sees the source code for
the program, and the same name will be used by all copies of the program
everywhere.</p>
<p>A better approach is to use the <tt class="docutils literal"><span class="pre">furlFile=</span></tt> argument. This
argument provides a filename that is used to hold the stable FURL for this
object. If the furlfile exists when <tt class="docutils literal"><span class="pre">registerReference</span></tt> is called,
the Tub will use the name inside it when constructing the new FURL. If it
doesn&#8217;t exist, it will create a new (unguessable) name. The new FURL will
always be written into the furlfile afterwards. In addition, the tubid in the
old FURL will be checked against the current Tub&#8217;s tubid to make sure it
matches. (this means that if you use furlFile=, you should also use the
certFile= argument when constructing the Tub).</p>
</div>
</div>
<div class="section" id="retrieving-a-remotereference">
<h3>Retrieving a RemoteReference<a class="headerlink" href="#retrieving-a-remotereference" title="Permalink to this headline">¶</a></h3>
<p>On the &#8220;client&#8221; side, you also need to create a Tub, although you
don&#8217;t need to perform the (<tt class="docutils literal"><span class="pre">listenOn</span></tt> , <tt class="docutils literal"><span class="pre">setLocation</span></tt> ,``registerReference`` ) sequence unless you are also publishing``Referenceable`` s to the world. To acquire a reference to somebody
else&#8217;s object, just use <a class="reference external" href="http://foolscap.lothar.com/docs/api/foolscap.pb.Tub-class.html#getReference">getReference</a> :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">foolscap.api</span> <span class="kn">import</span> <span class="n">Tub</span>

<span class="n">tub</span> <span class="o">=</span> <span class="n">Tub</span><span class="p">()</span>
<span class="n">tub</span><span class="o">.</span><span class="n">startService</span><span class="p">()</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">tub</span><span class="o">.</span><span class="n">getReference</span><span class="p">(</span><span class="s">&quot;pb://ABCD@myhost.example.com:12345/math-service&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">gotReference</span><span class="p">(</span><span class="n">remote</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&quot;Got the RemoteReference:&quot;</span><span class="p">,</span> <span class="n">remote</span>
<span class="k">def</span> <span class="nf">gotError</span><span class="p">(</span><span class="n">err</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&quot;error:&quot;</span><span class="p">,</span> <span class="n">err</span>
<span class="n">d</span><span class="o">.</span><span class="n">addCallbacks</span><span class="p">(</span><span class="n">gotReference</span><span class="p">,</span> <span class="n">gotError</span><span class="p">)</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">getReference</span></tt> returns a Deferred which will fire with a``RemoteReference`` that is connected to the remote``Referenceable`` named by the FURL. It will use an existing
connection, if one is available, and it will return an existing``RemoteReference`` , it one has already been acquired.</p>
<p>Since <tt class="docutils literal"><span class="pre">getReference</span></tt> requests are queued until the Tub starts,
the following will work too. But don&#8217;t forget to call``tub.startService()`` eventually, otherwise your program will hang
forever.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">foolscap.api</span> <span class="kn">import</span> <span class="n">Tub</span>

<span class="n">tub</span> <span class="o">=</span> <span class="n">Tub</span><span class="p">()</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">tub</span><span class="o">.</span><span class="n">getReference</span><span class="p">(</span><span class="s">&quot;pb://ABCD@myhost.example.com:12345/math-service&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">gotReference</span><span class="p">(</span><span class="n">remote</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&quot;Got the RemoteReference:&quot;</span><span class="p">,</span> <span class="n">remote</span>
<span class="k">def</span> <span class="nf">gotError</span><span class="p">(</span><span class="n">err</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&quot;error:&quot;</span><span class="p">,</span> <span class="n">err</span>
<span class="n">d</span><span class="o">.</span><span class="n">addCallbacks</span><span class="p">(</span><span class="n">gotReference</span><span class="p">,</span> <span class="n">gotError</span><span class="p">)</span>
<span class="n">tub</span><span class="o">.</span><span class="n">startService</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="complete-example">
<h3>Complete example<a class="headerlink" href="#complete-example" title="Permalink to this headline">¶</a></h3>
<p>Here are two programs, one implementing the server side of our
remote-addition protocol, the other behaving as a client. This first example
uses an unauthenticated Tub so you don&#8217;t have to manually copy a FURL from
the server to the client. Both of these are standalone programs (you just run
them), but normally you would create an <a class="reference external" href="http://foolscap.lothar.com/docs/api/twisted.application.service.Application-class.html">Application</a> object and pass the
file to <tt class="docutils literal"><span class="pre">twistd</span> <span class="pre">-noy</span></tt> . An example of that usage will be provided
later.</p>
<p><tt class="xref download docutils literal"><span class="pre">pb1server.py</span></tt></p>
<p><tt class="xref download docutils literal"><span class="pre">pb1client.py</span></tt></p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">%</span> doc/listings/pb1server.py
<span class="go">the object is available at: pbu://localhost:12345/math-service</span>
</pre></div>
</div>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">%</span> doc/listings/pb1client.py
<span class="go">got a RemoteReference</span>
<span class="go">asking it to add 1+2</span>
<span class="go">the answer is 3</span>
<span class="gp">%</span>
</pre></div>
</div>
<p>The second example uses authenticated Tubs. When running this example, you
must copy the FURL printed by the server and provide it as an argument to the
client.</p>
<p><tt class="xref download docutils literal"><span class="pre">pb2server.py</span></tt></p>
<p><tt class="xref download docutils literal"><span class="pre">pb2client.py</span></tt></p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">%</span> doc/listings/pb2server.py
<span class="go">the object is available at: pb://abcd123@localhost:12345/math-service</span>
</pre></div>
</div>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">%</span> doc/listings/pb2client.py pb://abcd123@localhost:12345/math-service
<span class="go">got a RemoteReference</span>
<span class="go">asking it to add 1+2</span>
<span class="go">the answer is 3</span>
<span class="gp">%</span>
</pre></div>
</div>
</div>
<div class="section" id="furls">
<h3>FURLs<a class="headerlink" href="#furls" title="Permalink to this headline">¶</a></h3>
<p>In Foolscap, each world-accessible Referenceable has one or more FURLs
which are &#8220;secure&#8221; , where we use the capability-security definition of
the term, meaning those FURLs have the following properties:</p>
<ul class="simple">
<li>The only way to acquire the FURL is either to get it from someone else
who already has it, or to be the person who published it in the first
place.</li>
<li>Only that original creator of the FURL gets to determine which
Referenceable it will connect to. If your
<tt class="docutils literal"><span class="pre">tub.getReference(url)</span></tt> call succeeds, the Referenceable you
will be connected to will be the right one.</li>
</ul>
<p>To accomplish the first goal, FURLs must be unguessable. You can register
the reference with a human-readable name if your intention is to make it
available to the world, but in general you will let``tub.registerReference`` generate a random name for you, preserving
the unguessability property.</p>
<p>To accomplish the second goal, the cryptographically-secure TubID is used
as the primary identifier, and the &#8220;location hints&#8221; are just that:
hints. If DNS has been subverted to point the hostname at a different
machine, or if a man-in-the-middle attack causes you to connect to the wrong
box, the TubID will not match the remote end, and the connection will be
dropped. These attacks can cause a denial-of-service, but they cannot cause
you to mistakenly connect to the wrong target.</p>
<p>Obviously this second property only holds if you use SSL. If you choose to
use unauthenticated Tubs, all security properties are lost.</p>
<p>The format of a FURL, like``pb:<a class="reference external" href="mailto://abcd123&#37;&#52;&#48;example&#46;com">//abcd123<span>&#64;</span>example<span>&#46;</span>com</a>:5901,backup.example.com:8800/math-server`` ,
is as follows <a class="footnote-reference" href="#id14" id="id3">[3]</a> :</p>
<ol class="arabic">
<li><p class="first">The literal string <tt class="docutils literal"><span class="pre">pb://</span></tt></p>
</li>
<li><p class="first">The TubID (as a base32-encoded hash of the SSL certificate)</p>
</li>
<li><p class="first">A literal <tt class="docutils literal"><span class="pre">&#64;</span></tt> sign</p>
</li>
<li><p class="first">A comma-separated list of &#8220;location hints&#8221; . Each is one of the
following:</p>
<ul class="simple">
<li>TCP over IPv4 via DNS: <tt class="docutils literal"><span class="pre">HOSTNAME:PORTNUM</span></tt></li>
<li>TCP over IPv4 without DNS: <tt class="docutils literal"><span class="pre">A.B.C.D:PORTNUM</span></tt></li>
<li>TCP over IPv6: (TODO, maybe <tt class="docutils literal"><span class="pre">tcp6:HOSTNAME:PORTNUM</span></tt> ?</li>
<li>TCP over IPv6 w/o DNS: (TODO,
maybe <tt class="docutils literal"><span class="pre">tcp6:[X:Y::Z]:PORTNUM</span></tt></li>
<li>Unix-domain socket: (TODO)</li>
</ul>
<p>Each location hint is attempted in turn. Servers can return a</p>
<p>&#8220;redirect&#8221; , which will cause the client to insert the provided
redirect targets into the hint list and start trying them before continuing
with the original list.</p>
</li>
<li><p class="first">A literal <tt class="docutils literal"><span class="pre">/</span></tt> character</p>
</li>
<li><p class="first">The reference&#8217;s name</p>
</li>
</ol>
<p>(Unix-domain sockets are represented with only a single location hint, in
the format <tt class="docutils literal"><span class="pre">pb://ABCD&#64;unix/path/to/socket/NAME</span></tt> , but this needs
some work)</p>
<p>FURLs for unauthenticated Tubs, like``pbu://example.com:8700/math-server`` , are formatted as
follows:</p>
<ol class="arabic simple">
<li>The literal string <tt class="docutils literal"><span class="pre">pbu://</span></tt></li>
<li>A comma-separated list of location hints, as above</li>
<li>A literal <tt class="docutils literal"><span class="pre">/</span></tt> character</li>
<li>The reference&#8217;s name</li>
</ol>
</div>
</div>
<div class="section" id="clients-vs-servers-names-and-capabilities">
<h2>Clients vs Servers, Names and Capabilities<a class="headerlink" href="#clients-vs-servers-names-and-capabilities" title="Permalink to this headline">¶</a></h2>
<p>It is worthwhile to point out that Foolscap is a symmetric protocol.``Referenceable`` instances can live on either side of a wire, and
the only difference between &#8220;client&#8221; and &#8220;server&#8221; is who publishes
the object and who initiates the network connection.</p>
<p>In any Foolscap-using system, the very first object exchanged must be
acquired with a <tt class="docutils literal"><span class="pre">tub.getReference(url)</span></tt> call <a class="footnote-reference" href="#id15" id="id4">[4]</a> , which means it must have been published with a call to``tub.registerReference(ref, name)`` . After that, other objects can
be passed as an argument to (or a return value from) a remotely-invoked
method of that first object. Any suitable <tt class="docutils literal"><span class="pre">Referenceable</span></tt> object
that is passed over the wire will appear on the other side as a corresponding``RemoteReference`` . It is not necessary to``registerReference`` something to let it pass over the wire.</p>
<p>The converse of this property is thus: if you do <em>not</em> <tt class="docutils literal"><span class="pre">registerReference</span></tt> a particular <tt class="docutils literal"><span class="pre">Referenceable</span></tt> , and
you do <em>not</em> give it to anyone else (by passing it in an argument to
somebody&#8217;s remote method, or return it from one of your own), then nobody
else will be able to get access to that <tt class="docutils literal"><span class="pre">Referenceable</span></tt> . This
property means the <tt class="docutils literal"><span class="pre">Referenceable</span></tt> is a &#8220;capability&#8221; , as
holding a corresponding <tt class="docutils literal"><span class="pre">RemoteReference</span></tt> gives someone a power
that they cannot acquire in any other way <a class="footnote-reference" href="#id16" id="id5">[5]</a></p>
<p>In the following example, the first program creates an RPN-style``Calculator`` object which responds to &#8220;push&#8221; , &#8220;pop&#8221; ,&#8221;add&#8221; , and &#8220;subtract&#8221; messages from the user. The user can also
register an <tt class="docutils literal"><span class="pre">Observer</span></tt> , to which the Calculator sends an``event`` message each time something happens to the calculator&#8217;s
state. When you consider the <tt class="docutils literal"><span class="pre">Calculator</span></tt> object, the first
program is the server and the second program is the client. When you think
about the <tt class="docutils literal"><span class="pre">Observer</span></tt> object, the first program is a client and the
second program is the server. It also happens that the first program is
listening on a socket, while the second program initiated a network
connection to the first. It <em>also</em> happens that the first program
published an object under some well-known name, while the second program has
not published any objects. These are all independent properties.</p>
<p>Also note that the Calculator side of the example is implemented using a:api:<cite>twisted.application.service.Application &lt;Application&gt;</cite>
object, which is the way you&#8217;d normally build a real-world application. You
therefore use <tt class="docutils literal"><span class="pre">twistd</span></tt> to launch the program. The User side is
written with the same <tt class="docutils literal"><span class="pre">reactor.run()</span></tt> style as the earlier
example.</p>
<p>The server registers the Calculator instance and prints the FURL at which
it is listening. You need to pass this FURL to the client program so it knows
how to contact the server. If you have a modern version of Twisted (2.5 or
later) and the right encryption libraries installed, you&#8217;ll get an
authenticated Tub (for which the FURL will start with &#8220;pb:&#8221; and will be
fairly long). If you don&#8217;t, you&#8217;ll get an unauthenticated Tub (with a
relatively short FURL that starts with &#8220;pbu:&#8221;).</p>
<p><tt class="xref download docutils literal"><span class="pre">pb3calculator.py</span></tt></p>
<p><tt class="xref download docutils literal"><span class="pre">pb3user.py</span></tt></p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">%</span> twistd -noy doc/listings/pb3calculator.py
<span class="go">15:46 PDT [-] Log opened.</span>
<span class="go">15:46 PDT [-] twistd 2.4.0 (/usr/bin/python 2.4.4) starting up</span>
<span class="go">15:46 PDT [-] reactor class: twisted.internet.selectreactor.SelectReactor</span>
<span class="go">15:46 PDT [-] Loading doc/listings/pb3calculator.py...</span>
<span class="go">15:46 PDT [-] the object is available at:</span>
<span class="go">              pb://5ojw4cv4u4d5cenxxekjukrogzytnhop@localhost:12345/calculator</span>
<span class="go">15:46 PDT [-] Loaded.</span>
<span class="go">15:46 PDT [-] foolscap.pb.Listener starting on 12345</span>
<span class="go">15:46 PDT [-] Starting factory &lt;Listener at 0x4869c0f4 on tcp:12345</span>
<span class="go">              with tubs None&gt;</span>
</pre></div>
</div>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">%</span> doc/listings/pb3user.py <span class="se">\</span>
<span class="go">   pb://5ojw4cv4u4d5cenxxekjukrogzytnhop@localhost:12345/calculator</span>
<span class="go">event: push(2)</span>
<span class="go">event: push(3)</span>
<span class="go">event: add</span>
<span class="go">event: pop</span>
<span class="go">the result is 5</span>
<span class="gp">%</span>
</pre></div>
</div>
</div>
<div class="section" id="invoking-methods-method-arguments">
<h2>Invoking Methods, Method Arguments<a class="headerlink" href="#invoking-methods-method-arguments" title="Permalink to this headline">¶</a></h2>
<p>As you&#8217;ve probably already guessed, all the methods with names that begin
with <tt class="docutils literal"><span class="pre">remote_</span></tt> will be available to anyone who manages to acquire
a corresponding <tt class="docutils literal"><span class="pre">RemoteReference</span></tt> . <tt class="docutils literal"><span class="pre">remote_foo</span></tt> matches
a <tt class="docutils literal"><span class="pre">ref.callRemote(&quot;foo&quot;)</span></tt> , etc. This name lookup can be changed by
overriding <tt class="docutils literal"><span class="pre">Referenceable</span></tt> (or, perhaps more usefully,
implementing an <a class="reference external" href="http://foolscap.lothar.com/docs/api/foolscap.ipb.IRemotelyCallable-class.html">IRemotelyCallable</a> adapter).</p>
<p>The arguments of a remote method may be passed as either positional
parameters (<tt class="docutils literal"><span class="pre">foo(1,2)</span></tt> ), or as keyword args
(<tt class="docutils literal"><span class="pre">foo(a=1,b=2)</span></tt> ), or a mixture of both. The usual python rules
about not duplicating parameters apply.</p>
<p>You can pass all sorts of normal objects to a remote method: strings,
numbers, tuples, lists, and dictionaries. The serialization of these objects
is handled by <a class="reference internal" href="specifications/banana.html"><em>Banana</em></a> , which knows
how to convey arbitrary object graphs over the wire. Things like containers
which contain multiple references to the same object, and recursive
references (cycles in the object graph) are all handled correctly <a class="footnote-reference" href="#id17" id="id6">[6]</a> .</p>
<p>Passing instances is handled specially. Foolscap will not send anything
over the wire that it does not know how to serialize, and (unlike the
standard <tt class="docutils literal"><span class="pre">pickle</span></tt> module) it will not make assumptions about how
to handle classes that that have not been explicitly marked as serializable.
This is for security, both for the sender (making sure you don&#8217;t pass anything
over the wire that you didn&#8217;t intend to let out of your security perimeter),
and for the recipient (making sure outsiders aren&#8217;t allowed to create
arbitrary instances inside your memory space, and therefore letting them run
somewhat arbitrary code inside <em>your</em> perimeter).</p>
<p>Sending <tt class="docutils literal"><span class="pre">Referenceable</span></tt> s is straightforward: they always appear
as a corresponding <tt class="docutils literal"><span class="pre">RemoteReference</span></tt> on the other side. You can
send the same <tt class="docutils literal"><span class="pre">Referenceable</span></tt> as many times as you like, and it
will always show up as the same <tt class="docutils literal"><span class="pre">RemoteReference</span></tt> instance. A
distributed reference count is maintained, so as long as the remote side
hasn&#8217;t forgotten about the <tt class="docutils literal"><span class="pre">RemoteReference</span></tt> , the original``Referenceable`` will be kept alive.</p>
<p>Sending <tt class="docutils literal"><span class="pre">RemoteReference</span></tt> s fall into two categories. If you are
sending a <tt class="docutils literal"><span class="pre">RemoteReference</span></tt> back to the Tub that you got it from,
they will see their original <tt class="docutils literal"><span class="pre">Referenceable</span></tt> . If you send it to
some other Tub, they will (eventually) see a <tt class="docutils literal"><span class="pre">RemoteReference</span></tt> of
their own. This last feature is called an &#8220;introduction&#8221; , and has a few
additional requirements: see the <a class="reference internal" href="#using-foolscap-introductions"><em>Introductions</em></a>
section of this document for details.</p>
<p>Sending instances of other classes requires that you tell Banana how they
should be serialized. <tt class="docutils literal"><span class="pre">Referenceable</span></tt> is good for
copy-by-reference semantics <a class="footnote-reference" href="#id18" id="id7">[7]</a> . For
copy-by-value semantics, the easiest route is to subclass <a class="reference external" href="http://foolscap.lothar.com/docs/api/foolscap.copyable.Copyable-class.html">Copyable</a> . See the <em class="xref std std-ref">Copyable</em> section for details. Note that you can also
register an <a class="reference external" href="http://foolscap.lothar.com/docs/api/foolscap.copyable.ICopyable-class.html">ICopyable</a>
adapter on third-party classes to avoid subclassing. You will need to
register the <tt class="docutils literal"><span class="pre">Copyable</span></tt> &#8216;s name on the receiving end too, otherwise
Banana will not know how to unserialize the incoming data stream.</p>
<p>When returning a value from a remote method, you can do all these things,
plus two more. If you raise an exception, the caller&#8217;s Deferred will have the
errback fired instead of the callback, with a <a class="reference external" href="http://foolscap.lothar.com/docs/api/foolscap.call.CopiedFailure-class.html">CopiedFailure</a> instance that describes what went
wrong. The <tt class="docutils literal"><span class="pre">CopiedFailure</span></tt> is not quite as useful as a
local <a class="reference external" href="http://foolscap.lothar.com/docs/api/twisted.python.failure.Failure-class.html">Failure</a> object
would be: see <a class="reference internal" href="failures.html"><em>failures.xhtml</em></a> for details.</p>
<p>The other alternative is for your method to return a <a class="reference external" href="http://foolscap.lothar.com/docs/api/twisted.internet.defer.Deferred-class.html">Deferred</a> . If this happens, the caller
will not actually get a response until you fire that Deferred. This is useful
when the remote operation being requested cannot complete right away. The
caller&#8217;s Deferred will fire with whatever value you eventually fire your own
Deferred with. If your Deferred is errbacked, their Deferred will be
errbacked with a <tt class="docutils literal"><span class="pre">CopiedFailure</span></tt> .</p>
</div>
<div class="section" id="constraints-and-remoteinterfaces">
<h2>Constraints and RemoteInterfaces<a class="headerlink" href="#constraints-and-remoteinterfaces" title="Permalink to this headline">¶</a></h2>
<p id="using-foolscap-constraints">One major feature introduced by Foolscap (relative to oldpb) is the
serialization <a class="reference external" href="http://foolscap.lothar.com/docs/api/foolscap.schema.Constraint-class.html">Constraint</a> .
This lets you place limits on what kind of data you are willing to accept,
which enables safer distributed programming. Typically python uses &#8220;duck typing&#8221; , wherein you usually just throw some arguments at the method and
see what happens. When you are less sure of the origin of those arguments,
you may want to be more circumspect. Enforcing type checking at the boundary
between your code and the outside world may make it safer to use duck typing
inside those boundaries. The type specifications also form a convenient
remote API reference you can publish for prospective clients of your
remotely-invokable service.</p>
<p>In addition, these Constraints are enforced on each token as it arrives
over the wire. This means that you can calculate a (small) upper bound on how
much received data your program will store before it decides to hang up on
the violator, minimizing your exposure to DoS attacks that involve sending
random junk at you.</p>
<p>There are three pieces you need to know about: Tokens, Constraints, and
RemoteInterfaces.</p>
<div class="section" id="tokens">
<h3>Tokens<a class="headerlink" href="#tokens" title="Permalink to this headline">¶</a></h3>
<p>The fundamental unit of serialization is the Banana Token. These are
thoroughly documented in the <a class="reference internal" href="specifications/banana.html"><em>Banana Specification</em></a> , but what you need to know here is that each piece of
non-container data, like a string or a number, is represented by a single
token. Containers (like lists and dictionaries) are represented by a special
OPEN token, followed by tokens for everything that is in the container,
followed by the CLOSE token. Everything Banana does is in terms of these
nested OPEN/stuff/stuff/CLOSE sequences of tokens.</p>
<p>Each token consists of a header, a type byte, and an optional body. The
header is always a base-128 number with a maximum of 64 digits, and the type
byte is always a single byte. The length of the body (if present) is
indicated by the number encoded in the header.</p>
<p>The length-first token format means that the receiving system never has to
accept more than 65 bytes before it knows the type and size of the token, at
which point it can make a decision about accepting or rejecting the rest of
it.</p>
</div>
<div class="section" id="constraints">
<h3>Constraints<a class="headerlink" href="#constraints" title="Permalink to this headline">¶</a></h3>
<p>The schema <tt class="docutils literal"><span class="pre">foolscap.schema</span></tt> module has a variety of <a class="reference external" href="http://foolscap.lothar.com/docs/api/foolscap.schema.Constraint-class.html">Constraint</a> classes that can be
applied to incoming data. Most of them correspond to typical Python types,
e.g. <a class="reference external" href="http://foolscap.lothar.com/docs/api/foolscap.schema.ListOf-class.html">ListOf</a> matches a list,
with a certain maximum length, and a child <tt class="docutils literal"><span class="pre">Constraint</span></tt> that gets
applied to the contents of the list. You can nest <tt class="docutils literal"><span class="pre">Constraint</span></tt> s in
this way to describe the &#8220;shape&#8221; of the object graph that you are
willing to accept.</p>
<p>At any given time, the receiving Banana protocol has a single``Constraint`` object that it enforces against the inbound data
stream <a class="footnote-reference" href="#id19" id="id8">[8]</a> .</p>
</div>
<div class="section" id="remoteinterfaces">
<h3>RemoteInterfaces<a class="headerlink" href="#remoteinterfaces" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference external" href="http://foolscap.lothar.com/docs/api/foolscap.remoteinterface.RemoteInterface-class.html">RemoteInterface</a> is how you describe
your constraints. You can provide a constraint for each argument of each
method, as well as one for the return value. You can also specify additional
flags on the methods. The convention (which is actually enforced by the code)
is to name <tt class="docutils literal"><span class="pre">RemoteInterface</span></tt> objects with an &#8220;RI&#8221; prefix,
like <tt class="docutils literal"><span class="pre">RIFoo</span></tt> .</p>
<p><tt class="docutils literal"><span class="pre">RemoteInterfaces</span></tt> are created and used a lot like the usual``zope.interface`` -style <tt class="docutils literal"><span class="pre">Interface</span></tt> . They look like
class definitions, inheriting from <tt class="docutils literal"><span class="pre">RemoteInterface</span></tt> . For each
method, the default value of each argument is used to create a``Constraint`` for that argument. Basic types (<tt class="docutils literal"><span class="pre">int</span></tt> ,``str`` , <tt class="docutils literal"><span class="pre">bool</span></tt> ) are converted into a``Constraint`` subclass (<a class="reference external" href="http://foolscap.lothar.com/docs/api/foolscap.schema.IntegerConstraint-class.html">IntegerConstraint</a> , <a class="reference external" href="http://foolscap.lothar.com/docs/api/foolscap.schema.StringConstraint-class.html">StringConstraint</a> , <a class="reference external" href="http://foolscap.lothar.com/docs/api/foolscap.schema.BooleanConstraint-class.html">BooleanConstraint</a> ). You can also use
instances of other <tt class="docutils literal"><span class="pre">Constraint</span></tt> subclasses, like <a class="reference external" href="http://foolscap.lothar.com/docs/api/foolscap.schema.ListOf-class.html">ListOf</a> and <a class="reference external" href="http://foolscap.lothar.com/docs/api/foolscap.schema.DictOf-class.html">DictOf</a> . This <tt class="docutils literal"><span class="pre">Constraint</span></tt> will be
enforced against the value for the given argument. Unless you specify
otherwise, remote callers must match all the <tt class="docutils literal"><span class="pre">Constraint</span></tt> s you
specify, all arguments listed in the RemoteInterface must be present, and no
arguments outside that list will be accepted.</p>
<p>Note that, like zope.interface, these methods should <strong>not</strong> include&#8221;<tt class="docutils literal"><span class="pre">self</span></tt>&#8221; in their argument list. This is because you are
documenting how <em>other</em> people invoke your methods. <tt class="docutils literal"><span class="pre">self</span></tt>
is an implementation detail. <tt class="docutils literal"><span class="pre">RemoteInterface</span></tt> will complain if
you forget.</p>
<p>The &#8220;methods&#8221; in a <tt class="docutils literal"><span class="pre">RemoteInterface</span></tt> should return a
single value with the same format as the default arguments: either a basic
type (<tt class="docutils literal"><span class="pre">int</span></tt> , <tt class="docutils literal"><span class="pre">str</span></tt> , etc) or a <tt class="docutils literal"><span class="pre">Constraint</span></tt>
subclass. This <tt class="docutils literal"><span class="pre">Constraint</span></tt> is enforced on the return value of the
method. If you are calling a method in somebody else&#8217;s process, the argument
constraints will be applied as a courtesy (&#8220;be conservative in what you send&#8221; ), and the return value constraint will be applied to prevent the
server from doing evil things to you. If you are running a method on behalf
of a remote client, the argument constraints will be enforced to protect*you* , while the return value constraint will be applied as a
courtesy.</p>
<p>Attempting to send a value that does not satisfy the Constraint will
result in a <a class="reference external" href="http://foolscap.lothar.com/docs/api/foolscap.Violation-class.html">Violation</a> exception
being raised.</p>
<p>You can also specify methods by defining attributes of the same name in
the <tt class="docutils literal"><span class="pre">RemoteInterface</span></tt> object. Each attribute value should be an
instance of <a class="reference external" href="http://foolscap.lothar.com/docs/api/foolscap.schema.RemoteMethodSchema-class.html">RemoteMethodSchema</a>  <a class="footnote-reference" href="#id20" id="id9">[9]</a> . This approach is more flexible: there are some constraints
that are not easy to express with the default-argument syntax, and this is
the only way to set per-method flags. Note that all such method-defining
attributes must be set in the <tt class="docutils literal"><span class="pre">RemoteInterface</span></tt> body itself,
rather than being set on it after the fact (i.e. <tt class="docutils literal"><span class="pre">RIFoo.doBar</span> <span class="pre">=</span> <span class="pre">stuff</span></tt> ). This is required because the <tt class="docutils literal"><span class="pre">RemoteInterface</span></tt>
metaclass magic processes all of these attributes only once, immediately
after the <tt class="docutils literal"><span class="pre">RemoteInterface</span></tt> body has been evaluated.</p>
<p>The <tt class="docutils literal"><span class="pre">RemoteInterface</span></tt> &#8220;class&#8221; has a name. Normally this is
the (short) classname <a class="footnote-reference" href="#id21" id="id10">[10]</a> . You can override this
name by setting a special <tt class="docutils literal"><span class="pre">__remote_name__</span></tt> attribute on the``RemoteInterface`` (again, in the body). This name is important
because it is externally visible: all <tt class="docutils literal"><span class="pre">RemoteReference</span></tt> s that
point at your <tt class="docutils literal"><span class="pre">Referenceable</span></tt> s will remember the name of the``RemoteInterface`` s it implements. This is what enables the
type-checking to be performed on both ends of the wire.</p>
<p>In the future, this ought to default to the <strong>fully-qualified</strong>
classname (like <tt class="docutils literal"><span class="pre">package.module.RIFoo</span></tt> ), so that two
RemoteInterfaces with the same name in different modules can co-exist. In the
current release, these two RemoteInterfaces will collide (and provoke an
import-time error message complaining about the duplicate name). As a result,
if you have such classes (e.g. <tt class="docutils literal"><span class="pre">foo.RIBar</span></tt> and``baz.RIBar`` ), you <strong>must</strong> use <tt class="docutils literal"><span class="pre">__remote_name__</span></tt> to
distinguish them (by naming one of them something other than``RIBar`` to avoid this error.</p>
<p>Hopefully this will be improved in a future version, but it looks like a
difficult change to implement, so the standing recommendation is to use``__remote_name__`` on all your RemoteInterfaces, and set it to a
suitably unique string (like a URI).</p>
<p>Here&#8217;s an example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">foolscap.api</span> <span class="kn">import</span> <span class="n">RemoteInterface</span><span class="p">,</span> <span class="n">schema</span>

<span class="k">class</span> <span class="nc">RIMath</span><span class="p">(</span><span class="n">RemoteInterface</span><span class="p">):</span>
    <span class="n">__remote_name__</span> <span class="o">=</span> <span class="s">&quot;RIMath.using-foolscap.docs.foolscap.twistedmatrix.com&quot;</span>
    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="nb">int</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">int</span>
    <span class="c"># declare it with an attribute instead of a function definition</span>
    <span class="n">subtract</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">RemoteMethodSchema</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">_response</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">sum</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="n">schema</span><span class="o">.</span><span class="n">ListOf</span><span class="p">(</span><span class="nb">int</span><span class="p">)):</span>
        <span class="k">return</span> <span class="nb">int</span>
</pre></div>
</div>
</div>
<div class="section" id="using-remoteinterface">
<h3>Using RemoteInterface<a class="headerlink" href="#using-remoteinterface" title="Permalink to this headline">¶</a></h3>
<p>To declare that your <tt class="docutils literal"><span class="pre">Referenceable</span></tt> responds to a particular``RemoteInterface`` , use the normal <tt class="docutils literal"><span class="pre">implements()</span></tt>
annotation:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MathServer</span><span class="p">(</span><span class="n">foolscap</span><span class="o">.</span><span class="n">Referenceable</span><span class="p">):</span>
    <span class="n">implements</span><span class="p">(</span><span class="n">RIMath</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">remote_add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span>
    <span class="k">def</span> <span class="nf">remote_subtract</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">-</span><span class="n">b</span>
    <span class="k">def</span> <span class="nf">remote_sum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span> <span class="n">total</span> <span class="o">+=</span> <span class="n">a</span>
        <span class="k">return</span> <span class="n">total</span>
</pre></div>
</div>
<p>To enforce constraints everywhere, both sides will need to know about the``RemoteInterface`` , and both must know it by the same name. It is a
good idea to put the <tt class="docutils literal"><span class="pre">RemoteInterface</span></tt> in a common file that is
imported into the programs running on both sides. It is up to you to make
sure that both sides agree on the interface. Future versions of Foolscap may
implement some sort of checksum-verification or Interface-serialization as a
failsafe, but fundamentally the <tt class="docutils literal"><span class="pre">RemoteInterface</span></tt> that*you* are using defines what <em>your</em> program is prepared to
handle. There is no difference between an old client accidentally using a
different version of the RemoteInterface by mistake, and a malicious attacker
actively trying to confuse your code. The only promise that Foolscap can make
is that the constraints you provide in the RemoteInterface will be faithfully
applied to the incoming data stream, so that you don&#8217;t need to do the type
checking yourself inside the method.</p>
<p>When making a remote method call, you use the <tt class="docutils literal"><span class="pre">RemoteInterface</span></tt>
to identify the method instead of a string. This scopes the method name to
the RemoteInterface:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">d</span> <span class="o">=</span> <span class="n">remote</span><span class="o">.</span><span class="n">callRemote</span><span class="p">(</span><span class="n">RIMath</span><span class="p">[</span><span class="s">&quot;add&quot;</span><span class="p">],</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c"># or</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">remote</span><span class="o">.</span><span class="n">callRemote</span><span class="p">(</span><span class="n">RIMath</span><span class="p">[</span><span class="s">&quot;add&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="pass-by-copy">
<h2>Pass-By-Copy<a class="headerlink" href="#pass-by-copy" title="Permalink to this headline">¶</a></h2>
<p>You can pass (nearly) arbitrary instances over the wire. Foolscap knows
how to serialize all of Python&#8217;s native data types already: numbers, strings,
unicode strings, booleans, lists, tuples, dictionaries, sets, and the None
object. You can teach it how to serialize instances of other types too.
Foolscap will not serialize (or deserialize) any class that you haven&#8217;t
taught it about, both for security and because it refuses the temptation to
guess your intentions about how these unknown classes ought to be
serialized.</p>
<p>The simplest possible way to pass things by copy is demonstrated in the
following code fragment:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">foolscap.api</span> <span class="kn">import</span> <span class="n">Copyable</span><span class="p">,</span> <span class="n">RemoteCopy</span>

<span class="k">class</span> <span class="nc">MyPassByCopy</span><span class="p">(</span><span class="n">Copyable</span><span class="p">,</span> <span class="n">RemoteCopy</span><span class="p">):</span>
    <span class="n">typeToCopy</span> <span class="o">=</span> <span class="n">copytype</span> <span class="o">=</span> <span class="s">&quot;MyPassByCopy&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># RemoteCopy subclasses may not accept any __init__ arguments</span>
        <span class="k">pass</span>
    <span class="k">def</span> <span class="nf">setCopyableState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span> <span class="o">=</span> <span class="n">state</span>
</pre></div>
</div>
<p>If the code on both sides of the wire import this class, then any
instances of <tt class="docutils literal"><span class="pre">MyPassByCopy</span></tt> that are present in the arguments of a
remote method call (or returned as the result of a remote method call) will
be serialized and reconstituted into an equivalent instance on the other
side.</p>
<p>For more complicated things to do with pass-by-copy, see the documentation
on <a class="reference internal" href="copyable.html"><em>Copyable</em></a> . This explains the difference between``Copyable`` and <tt class="docutils literal"><span class="pre">RemoteCopy</span></tt> , how to control the
serialization and deserialization process, and how to arrange for
serialization of third-party classes that are not subclasses of``Copyable`` .</p>
</div>
<div class="section" id="third-party-references">
<h2>Third-party References<a class="headerlink" href="#third-party-references" title="Permalink to this headline">¶</a></h2>
<p id="using-foolscap-introductions">Another new feature of Foolscap is the ability to send``RemoteReference`` s to third parties. The classic scenario for this
is illustrated by the <a class="reference external" href="http://www.erights.org/elib/capability/overview.html">three-partyGranovetter diagram</a> . One party (Alice) has RemoteReferences to two other
objects named Bob and Carol. She wants to share her reference to Carol with
Bob, by including it in a message she sends to Bob (i.e. by using it as an
argument when she invokes one of Bob&#8217;s remote methods). The Foolscap code for
doing this would look like:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">bobref</span><span class="o">.</span><span class="n">callRemote</span><span class="p">(</span><span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="n">intro</span><span class="o">=</span><span class="n">carolref</span><span class="p">)</span>
</pre></div>
</div>
<p>When Bob receives this message (i.e. when his <tt class="docutils literal"><span class="pre">remote_foo</span></tt>
method is invoked), he will discover that he&#8217;s holding a fully-functional``RemoteReference`` to the object named Carol <a class="footnote-reference" href="#id22" id="id11">[11]</a> . He can
start using this RemoteReference right away:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Bob</span><span class="p">(</span><span class="n">foolscap</span><span class="o">.</span><span class="n">Referenceable</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">remote_foo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">intro</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">carol</span> <span class="o">=</span> <span class="n">intro</span>
        <span class="n">carol</span><span class="o">.</span><span class="n">callRemote</span><span class="p">(</span><span class="s">&quot;howdy&quot;</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="s">&quot;Pleased to meet you&quot;</span><span class="p">,</span> <span class="n">you</span><span class="o">=</span><span class="n">intro</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">carol</span>
</pre></div>
</div>
<p>If Bob sends this <tt class="docutils literal"><span class="pre">RemoteReference</span></tt> back to Alice, her method
will see the same <tt class="docutils literal"><span class="pre">RemoteReference</span></tt> that she sent to Bob. In this
example, Bob sends the reference by returning it from the original``remote_foo`` method call, but he could almost as easily send it in
a separate method call.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Alice</span><span class="p">(</span><span class="n">foolscap</span><span class="o">.</span><span class="n">Referenceable</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">carol</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">carol</span> <span class="o">=</span> <span class="n">carol</span>
        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bob</span><span class="o">.</span><span class="n">callRemote</span><span class="p">(</span><span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="n">intro</span><span class="o">=</span><span class="n">carol</span><span class="p">)</span>
        <span class="n">d</span><span class="o">.</span><span class="n">addCallback</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">didFoo</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">didFoo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">result</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">carol</span>  <span class="c"># this will be true</span>
</pre></div>
</div>
<p>Moreover, if Bob sends it back to <em>Carol</em> (completing the
three-party round trip), Carol will see it as her original``Referenceable`` .</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Carol</span><span class="p">(</span><span class="n">foolscap</span><span class="o">.</span><span class="n">Referenceable</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">remote_howdy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">you</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">you</span> <span class="ow">is</span> <span class="bp">self</span>  <span class="c"># this will be true</span>
</pre></div>
</div>
<p>In addition to this, in the four-party introduction sequence as used by
the <a class="reference external" href="http://www.erights.org/elib/equality/grant-matcher/index.html">GrantMatcher Puzzle</a> , when a Referenceable is sent to the same destination
through multiple paths, the recipient will receive the same``RemoteReference`` object from both sides.</p>
<p>For a <tt class="docutils literal"><span class="pre">RemoteReference</span></tt> to be transferrable to third-parties in
this fashion, the original <tt class="docutils literal"><span class="pre">Referenceable</span></tt> must live in a Tub
which has a working listening port, and an established base FURL. It is not
necessary for the Referenceable to have been published with``registerReference`` first: if it is sent over the wire before a
name has been associated with it, it will be registered under a new random
and unguessable name. The <tt class="docutils literal"><span class="pre">RemoteReference</span></tt> will contain the
resulting FURL, enabling it to be sent to third parties.</p>
<p>When this introduction is made, the receiving system must establish a
connection with the Tub that holds the original Referenceable, and acquire
its own RemoteReference. These steps must take place before the remote method
can be invoked, and other method calls might arrive before they do. All
subsequent method calls are queued until the one that involved the
introduction is performed. Foolscap guarantees (by default) that the messages
sent to a given Referenceable will be delivered in the same order. In the
future there may be options to relax this guarantee, in exchange for higher
performance, reduced memory consumption, multiple priority queues, limited
latency, or other features. There might even be an option to turn off
introductions altogether.</p>
<p>Also note that enabling this capability means any of your communication
peers can make you create TCP connections to hosts and port numbers of their
choosing. The fact that those connections can only speak the Foolscap
protocol may reduce the security risk presented, but it still lets other
people be annoying.</p>
<p class="rubric">Footnotes</p>
<table class="docutils footnote" frame="void" id="id12" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>although
really, if your client machine is too slow to perform this kind of math, it
is probably too slow to run python or use a network, so you should seriously
consider a hardware upgrade</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id13" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td>but they do not provide quite the same insulation against
other objects as E&#8217;s Vats do. In this sense, Tubs are leaky Vats.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id14" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[3]</a></td><td>note that the FURL uses the same format
as an <a class="reference external" href="http://www.waterken.com/dev/YURL/httpsy/">HTTPSY</a>
URL</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id15" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[4]</a></td><td>in fact, the very <em>very</em>  first object exchanged is a
special implicit RemoteReference to the remote Tub itself, which implements
an internal protocol that includes a method named
<tt class="docutils literal"><span class="pre">remote_getReference</span></tt> . The <tt class="docutils literal"><span class="pre">tub.getReference(url)</span></tt>  call
is turned into one step that connects to the remote Tub, and a second step
which invokes remotetub.callRemote(&#8220;getReference&#8221;, refname) on the
result</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id16" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[5]</a></td><td>of course,
the Foolscap connections must be secured with SSL (otherwise an eavesdropper
or man-in-the-middle could get access), and the registered name must be
unguessable (or someone else could acquire a reference), but both of these
are the default.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id17" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[6]</a></td><td>you may not want to accept shared objects in your method
arguments, as it could lead to surprising behavior depending upon how you
have written your method. The <a class="reference external" href="http://foolscap.lothar.com/docs/api/foolscap.schema.Shared-class.html">Shared</a>  constraint will let you express this,
and is described in the <a class="reference internal" href="#using-foolscap-constraints"><em>Constraints</em></a>  section of
this document</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id18" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[7]</a></td><td>In fact, if all you want is
referenceability (and not callability), you can use <a class="reference external" href="http://foolscap.lothar.com/docs/api/foolscap.referenceable.OnlyReferenceable-class.html">OnlyReferenceable</a> . Strictly speaking,
<tt class="docutils literal"><span class="pre">Referenceable</span></tt>  is both &#8220;Referenceable&#8221;  (meaning it is sent
over the wire using pass-by-reference semantics, and it survives a round
trip) and &#8220;Callable&#8221;  (meaning you can invoke remote methods on it).
<tt class="docutils literal"><span class="pre">Referenceable</span></tt>  should really be named <tt class="docutils literal"><span class="pre">Callable</span></tt> , but
the existing name has a lot of historical weight behind it.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id19" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id8">[8]</a></td><td>to be precise, each <tt class="docutils literal"><span class="pre">Unslicer</span></tt>  on the
receive stack has a <tt class="docutils literal"><span class="pre">Constraint</span></tt> , and the idea is that all of them
get to pass judgement on the inbound token. A useful syntax to describe this
sort of thing is still being worked out.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id20" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id9">[9]</a></td><td>although technically it can be any object which implements
the <a class="reference external" href="http://foolscap.lothar.com/docs/api/foolscap.schema.IRemoteMethodConstraint-class.html">IRemoteMethodConstraint</a>
interface</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id21" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id10">[10]</a></td><td><tt class="docutils literal"><span class="pre">RIFoo.__class__.__name__</span></tt> , if
<tt class="docutils literal"><span class="pre">RemoteInterface</span></tt> s were actually classes, which they&#8217;re
not</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id22" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id11">[11]</a></td><td>and if everyone involved is using authenticated Tubs, then
Foolscap offers a guarantee, in the cryptographic sense, that Bob will wind
up with a reference to the same object that Alice intended. The authenticated
FURLs prevent DNS-spoofing and man-in-the-middle attacks.</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Introduction to Foolscap</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#getting-started">Getting Started</a></li>
<li><a class="reference internal" href="#tubs-the-foolscap-service">Tubs: The Foolscap Service</a><ul>
<li><a class="reference internal" href="#making-your-tub-remotely-accessible">Making your Tub remotely accessible</a></li>
<li><a class="reference internal" href="#registering-the-referenceable">Registering the Referenceable</a><ul>
<li><a class="reference internal" href="#using-a-persistent-certificate">Using a persistent certificate</a></li>
<li><a class="reference internal" href="#using-a-persistent-furl">Using a Persistent FURL</a></li>
</ul>
</li>
<li><a class="reference internal" href="#retrieving-a-remotereference">Retrieving a RemoteReference</a></li>
<li><a class="reference internal" href="#complete-example">Complete example</a></li>
<li><a class="reference internal" href="#furls">FURLs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#clients-vs-servers-names-and-capabilities">Clients vs Servers, Names and Capabilities</a></li>
<li><a class="reference internal" href="#invoking-methods-method-arguments">Invoking Methods, Method Arguments</a></li>
<li><a class="reference internal" href="#constraints-and-remoteinterfaces">Constraints and RemoteInterfaces</a><ul>
<li><a class="reference internal" href="#tokens">Tokens</a></li>
<li><a class="reference internal" href="#constraints">Constraints</a></li>
<li><a class="reference internal" href="#remoteinterfaces">RemoteInterfaces</a></li>
<li><a class="reference internal" href="#using-remoteinterface">Using RemoteInterface</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pass-by-copy">Pass-By-Copy</a></li>
<li><a class="reference internal" href="#third-party-references">Third-party References</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Welcome to Foolscap&#8217;s documentation!</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="copyable.html"
                        title="next chapter">Using Pass-By-Copy in Foolscap</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/using-foolscap.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="copyable.html" title="Using Pass-By-Copy in Foolscap"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to Foolscap’s documentation!"
             >previous</a> |</li>
        <li><a href="index.html">Foolscap v0.6.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Brian Warner.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>